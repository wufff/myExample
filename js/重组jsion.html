<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<title>重组json</title>
<meta name="description" content="">
<meta name="keywords" content="">
<link href="" rel="stylesheet">
</head>
<body>
    
</body>
    
 <script type="text/javascript">
 var j = {
	"121502": {
		"1": {
			"2017": {
				"201701": {
					"class_id": 437589,
					"class_name": "201701",
					"class_nickname": "",
					"class_logo": "",
					"class_logo_path": "http:\/\/images.dev.dodoedu.com\/shequPage\/common\/image\/def-class-145.gif",
					"class_year": "2017",
					"class_type": "1",
					"class_grade": "小学二年级",
					"school_id": "121502",
					"school_name": "长江数字小学",
					"is_default_class": 0,
					"is_administrator": 0,
					"invitation": ""
				}
			},
			"2016": {
				"201611": {
					"class_id": 437524,
					"class_name": "201611",
					"class_nickname": "",
					"class_logo": "",
					"class_logo_path": "http:\/\/images.dev.dodoedu.com\/shequPage\/common\/image\/def-class-145.gif",
					"class_year": "2016",
					"class_type": "1",
					"class_grade": "小学三年级",
					"school_id": "121502",
					"school_name": "长江数字小学",
					"is_default_class": 0,
					"is_administrator": 1,
					"invitation": "CYUN4N"
				},
				"201601": {
					"class_id": 435053,
					"class_name": "201601",
					"class_nickname": "",
					"class_logo": "",
					"class_logo_path": "http:\/\/images.dev.dodoedu.com\/shequPage\/common\/image\/def-class-145.gif",
					"class_year": "2016",
					"class_type": "1",
					"class_grade": "小学三年级",
					"school_id": "121502",
					"school_name": "长江数字小学",
					"is_default_class": 0,
					"is_administrator": 0,
					"invitation": ""
				},
				"201602": {
					"class_id": 435054,
					"class_name": "201602",
					"class_nickname": "",
					"class_logo": "",
					"class_logo_path": "http:\/\/images.dev.dodoedu.com\/shequPage\/common\/image\/def-class-145.gif",
					"class_year": "2016",
					"class_type": "1",
					"class_grade": "小学三年级",
					"school_id": "121502",
					"school_name": "长江数字小学",
					"is_default_class": 0,
					"is_administrator": 0,
					"invitation": ""
				},
				"201604": {
					"class_id": 435070,
					"class_name": "201604",
					"class_nickname": "",
					"class_logo": "",
					"class_logo_path": "http:\/\/images.dev.dodoedu.com\/shequPage\/common\/image\/def-class-145.gif",
					"class_year": "2016",
					"class_type": "1",
					"class_grade": "小学三年级",
					"school_id": "121502",
					"school_name": "长江数字小学",
					"is_default_class": 0,
					"is_administrator": 0,
					"invitation": ""
				}
			},
			"2015": {
				"201504": {
					"class_id": 434901,
					"class_name": "201504",
					"class_nickname": "火箭快班",
					"class_logo": "20171490166664-1332380-9105-2271.jpg",
					"class_logo_path": "http:\/\/images.dev.dodoedu.com\/image\/20171490166664-1332380-9105-2271-145.jpg",
					"class_year": "2015",
					"class_type": "1",
					"class_grade": "小学四年级",
					"school_id": "121502",
					"school_name": "长江数字小学",
					"is_default_class": 0,
					"is_administrator": 1,
					"invitation": "CFFKR4"
				},
				"201501": {
					"class_id": 434902,
					"class_name": "201501",
					"class_nickname": "飞龙在天",
					"class_logo": "20161461202883-1227314-6595-9451.jpg",
					"class_logo_path": "http:\/\/images.dev.dodoedu.com\/image\/20161461202883-1227314-6595-9451-145.jpg",
					"class_year": "2015",
					"class_type": "1",
					"class_grade": "小学四年级",
					"school_id": "121502",
					"school_name": "长江数字小学",
					"is_default_class": 0,
					"is_administrator": 0,
					"invitation": ""
				}
			},
			"2013": {
				"201304": {
					"class_id": 337640,
					"class_name": "201304",
					"class_nickname": "",
					"class_logo": "",
					"class_logo_path": "http:\/\/images.dev.dodoedu.com\/shequPage\/common\/image\/def-class-145.gif",
					"class_year": "2013",
					"class_type": "1",
					"class_grade": "小学六年级",
					"school_id": "121502",
					"school_name": "长江数字小学",
					"is_default_class": 0,
					"is_administrator": 1,
					"invitation": "CZ2PA8"
				}
			}
		},
		"2": {
			"2016": {
				"201601": {
					"class_id": 435100,
					"class_name": "201601",
					"class_nickname": "",
					"class_logo": "",
					"class_logo_path": "http:\/\/images.dev.dodoedu.com\/shequPage\/common\/image\/def-class-145.gif",
					"class_year": "2016",
					"class_type": "2",
					"class_grade": "初中三年级",
					"school_id": "121502",
					"school_name": "长江数字小学",
					"is_default_class": 0,
					"is_administrator": 0,
					"invitation": ""
				}
			}
		}
	},
	"121584": {
		"1": {
			"2015": {
				"201599": {
					"class_id": 434899,
					"class_name": "201599",
					"class_nickname": "",
					"class_logo": "20151446538102-113297-7418-8690.jpg",
					"class_logo_path": "http:\/\/images.dev.dodoedu.com\/image\/20151446538102-113297-7418-8690-145.jpg",
					"class_year": "2015",
					"class_type": "1",
					"class_grade": "小学四年级",
					"school_id": "121584",
					"school_name": "长江实验小学",
					"is_default_class": 0,
					"is_administrator": 0,
					"invitation": ""
				}
			},
			"2014": {
				"201404": {
					"class_id": 434834,
					"class_name": "201404",
					"class_nickname": "",
					"class_logo": "",
					"class_logo_path": "http:\/\/images.dev.dodoedu.com\/shequPage\/common\/image\/def-class-145.gif",
					"class_year": "2014",
					"class_type": "1",
					"class_grade": "小学五年级",
					"school_id": "121584",
					"school_name": "长江实验小学",
					"is_default_class": 0,
					"is_administrator": 0,
					"invitation": ""
				}
			}
		}
	},
	"123908": {
		"3": {
			"2016": {
				"201601": {
					"class_id": 435081,
					"class_name": "201601",
					"class_nickname": "阳光学习班",
					"class_logo": "20161479089838-1229348-9707-5432.jpg",
					"class_logo_path": "http:\/\/images.dev.dodoedu.com\/shequPage\/common\/image\/class-145.gif",
					"class_year": "2016",
					"class_type": "3",
					"class_grade": "高中三年级",
					"school_id": "123908",
					"school_name": "测试二中",
					"is_default_class": 0,
					"is_administrator": 0,
					"invitation": ""
				}
			}
		}
	},
	"108591": {
		"1": {
			"2016": {
				"201615": {
					"class_id": 437533,
					"class_name": "201615",
					"class_nickname": "",
					"class_logo": "",
					"class_logo_path": "http:\/\/images.dev.dodoedu.com\/shequPage\/common\/image\/def-class-145.gif",
					"class_year": "2016",
					"class_type": "1",
					"class_grade": "小学三年级",
					"school_id": "108591",
					"school_name": "武昌区丁字桥小学",
					"is_default_class": 0,
					"is_administrator": 0,
					"invitation": ""
				}
			}
		}
	}
}



// { "小学":{"班级"：[{id:123},{name:123}]}}
function dedupe(array){
   return Array.from(new Set(array));
}



var jk =[];
var qk = [];
var obj ={};

 for ( var k in j ){
    for ( var m in j[k] ){
      for ( var  n in j[k][m]){
         for ( o in j[k][m][n]){
         	var objk = j[k][m][n][o];
         	// if(!obj[objk]){
         	// 	obj[objk] = {};
         	// }
         	qk.push(objk);
         }
      }
    }
 }
 for ( var i = 0; i< qk.length; i++){
 	 var temp = qk[i].school_name;
 	 if(!obj[temp]){
 	 	obj[temp] = [];
 	 	obj[temp].push(qk[i]);
 	 }else{
 	 	obj[temp].push(qk[i]);
 	 }
 }

for (var k in obj){
	 var temp3 = obj[k];
	 obj[k] = {};
    for( var i= 0;i<temp3.length;i++){
         var  temp2 = temp3[i].class_grade;
          if(!obj[k][temp2]){
	 	 	obj[k][temp2] = [];
	 	 	obj[k][temp2].push(temp3[i]);
	 	 }else{
	 	 	obj[k][temp2].push(temp3[i]);
	 	 }
    }
}

console.log(obj);
 </script>

</html>
